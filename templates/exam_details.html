<!doctype html>
<html>
<head>
<title>Exam Details</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; }
form { background: #f5f5f5; padding: 20px; border-radius: 8px; max-width: 800px; }
input[type="text"], input[type="number"] { padding: 8px; margin: 5px 0; border: 1px solid #ddd; border-radius: 4px; }
input[type="submit"] { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
.exam-section { background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border: 1px solid #ddd; }
.clo-section { background: white; padding: 15px; margin: 10px 0; border-radius: 5px; border: 1px solid #ddd; }
.clo-names-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-top: 10px; }
.clo-name-input { display: flex; flex-direction: column; }
.clo-name-input label { font-weight: bold; margin-bottom: 5px; }
.clo-name-input input { width: 100%; }
</style>
<script>
window.initialCloNames = {{ clo_names|tojson }};
function updateCloNames() {
    const input = document.getElementById('clo_count');
    const cloCount = parseInt(input.value || '0');
    const container = document.getElementById('clo_names_container');
    container.innerHTML = '';
    for (let i = 0; i < cloCount; i++) {
        const div = document.createElement('div');
        div.className = 'clo-name-input';
        const label = document.createElement('label');
        label.textContent = `CLO ${i + 1} Name:`;
        const txt = document.createElement('input');
        txt.type = 'text';
        txt.name = `clo_name_${i}`;
        txt.placeholder = `Enter CLO ${i + 1} name`;
        txt.required = true;
        if (Array.isArray(window.initialCloNames) && i < window.initialCloNames.length) {
            txt.value = window.initialCloNames[i] || '';
        }
        div.appendChild(label);
        div.appendChild(txt);
        container.appendChild(div);
    }
}

window.addEventListener('DOMContentLoaded', updateCloNames);
</script>
</head>
<body>
<h2>Exam Details & CLO Configuration</h2>
<form method="post">
  <!-- CLO Configuration Section -->
  <div class="clo-section">
    <h3>üìö Course Learning Outcomes (CLO) Configuration</h3>
    <label>Number of CLOs:
      <input id="clo_count" name="clo_count" type="number" min="1" step="1" value="{{ clo_count }}" oninput="updateCloNames()" required>
    </label>
    <div id="clo_names_container" class="clo-names-container">
      <!-- CLO name inputs are generated by JS -->
    </div>
  </div>

  <!-- Exam Details Section -->
  <div class="exam-section">
    <h3>üìù Exam Details</h3>
    {% for i in range(exam_count) %}
      <div class="exam-section">
        <h4>Exam {{ i+1 }}</h4>
        <label>Exam Name: <input type="text" name="exam_name_{{i}}" placeholder="E.g: Midterm Exam" required></label><br>
        <label>Question Count: <input type="number" name="question_count_{{i}}" min="1" max="50" required></label><br>
        <label>Exam Weight (%): <input type="number" name="weight_{{i}}" min="1" max="100" required></label><br>
      </div>
    {% endfor %}
  </div>
  
  <input type="submit" value="Save and Continue">
</form>
</body>
</html>